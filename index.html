<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Malaria vaccine impact tracker</title>
  <link rel="stylesheet" href="app.css">
</head>
<body>

  <!-- Top controls -->
  <div class="topbar">
    <!-- Row 1: Country/Region, Display, Mode -->
    <div class="row row-top">
      <div>
        <label class="lbl" for="country">Country/Region</label><br>
        <select id="country">
          <option>Africa (overall)</option>
        </select>
      </div>

      <div>
        <label class="lbl" for="view">Display</label><br>
        <select id="view">
          <option value="trackers" selected>Live trackers</option>
          <option value="trends">Trends</option>
          <option value="needs">Vaccination needs</option>
        </select>
      </div>

      <div>
        <label class="lbl" for="mode">Mode</label><br>
        <select id="mode">
          <option value="dashboard" selected>By country/region</option>
          <option value="compare">Compare countries</option>
        </select>
      </div>
    </div>

    <!-- Row 2: Metric, Range, Vaccine (inserted by JS), Sort, Top N, Window label -->
    <div id="controlsRow" class="row row-sub" style="display:none">
      <!-- Metric -->
      <div>
        <span id="metricLbl" class="lbl">Metric</span><br>
        <select id="trendMetric">
          <option value="doses_delivered" selected>Doses delivered</option>
          <option value="doses">Doses administered</option>
          <option value="children">Children vaccinated</option>
          <option value="cases">Cases averted</option>
          <option value="lives">Lives saved</option>
        </select>
      </div>

      <!-- Range (dashboard trends only) -->
      <div>
        <span id="rangeLbl" class="lbl">Range</span><br>
        <select id="range">
          <option value="6">Last 6 months</option>
          <option value="12">Last 12 months</option>
          <option value="24" selected>Last 24 months</option>
          <option value="all">All available</option>
        </select>
      </div>

      <!-- Vaccine filter placeholder (JS replaces this with real control) -->
      <div id="vaccineControl"></div>

      <!-- Sort (compare mode only) -->
      <div>
        <span id="sortLbl" class="lbl">Sort</span><br>
        <select id="sort">
          <option value="desc" selected>Largest first</option>
          <option value="asc">Smallest first</option>
        </select>
      </div>

      <!-- Top N (compare mode only) -->
      <div>
        <span id="topNLbl" class="lbl">Show</span><br>
        <select id="topN">
          <option>5</option>
          <option selected>10</option>
          <option value="all">All</option>
        </select>
      </div>

      <!-- Availability window label for trends -->
      <span id="win" class="win"></span>
    </div>
  </div>

  <!-- Dashboard wrapper (trackers + trends) -->
  <main id="dashboard">
    <h1 class="title">Malaria vaccine impact tracker</h1>

    <!-- Live trackers -->
    <section id="trackers">
      <div class="metric">
        <div class="label">Total cases averted</div>
        <div id="caseTotal" class="value">–</div>
        <div class="bar">
          <div id="caseBar" class="fill"></div>
        </div>
        <div id="caseTimer" class="timer">Loading…</div>
      </div>

      <div class="metric">
        <div class="label">Total lives saved</div>
        <div id="lifeTotal" class="value">–</div>
        <div class="bar">
          <div id="lifeBar" class="fill"></div>
        </div>
        <div id="lifeTimer" class="timer">Loading…</div>
      </div>

      <!-- Shipments summary (populated by app.js; shown only in tracker view) -->
      <p id="ship"></p>
    </section>

    <!-- Trends view -->
    <section id="trends" style="display:none">
      <div id="trendCanvasWrap" class="trendCanvasWrap">
        <div id="yLabel" class="y-label">Doses delivered</div>
        <canvas id="trend"></canvas>
        <div id="trendTooltip" class="trendTooltip" style="display:none"></div>
        <div id="trendDot" class="trendDot"></div>
      </div>
      <div id="empty" class="empty" style="display:none">
        No data for selected range.
      </div>
    </section>

    <!-- Vaccination needs view -->
    <section id="needs" style="display:none">
      <div class="needs-controls">
        <div>
          <label class="lbl" for="ageGroup">Age window</label><br>
          <select id="ageGroup">
            <option value="6-60" selected>6–60 months</option>
            <option value="5-36">5–36 months</option>
          </select>
        </div>
        <div>
          <label class="lbl" for="needsVaccine">Vaccine price</label><br>
          <select id="needsVaccine">
            <option value="R21" selected>R21 ($2.99/dose)</option>
            <option value="RTS,S">RTS,S ($9.81/dose)</option>
          </select>
        </div>
      </div>

      <div class="needs-grid">
        <!-- Coverage gap -->
        <div class="needs-card">
          <div class="needs-card-title">Coverage Gap</div>
          <div class="needs-stat">
            <span class="needs-value" id="needsGap">–</span>
            <span class="needs-label">children not yet vaccinated</span>
          </div>
          <div class="needs-detail" id="needsCoverage">–</div>
        </div>

        <!-- Catch-up doses needed -->
        <div class="needs-card">
          <div class="needs-card-title">Catch-up Doses Needed</div>
          <div class="needs-stat">
            <span class="needs-value" id="needsDoses">–</span>
            <span class="needs-label">doses to close the gap</span>
          </div>
          <div class="needs-detail" id="needsDosesCost">–</div>
        </div>

        <!-- Annual flow -->
        <div class="needs-card">
          <div class="needs-card-title">Annual Maintenance</div>
          <div class="needs-stat">
            <span class="needs-value" id="needsAnnual">–</span>
            <span class="needs-label">doses per year for new births</span>
          </div>
          <div class="needs-detail" id="needsAnnualCost">–</div>
        </div>

        <!-- Cost-effectiveness -->
        <div class="needs-card">
          <div class="needs-card-title">Cost-Effectiveness</div>
          <div class="needs-stat">
            <span class="needs-value" id="needsCostPerLife">–</span>
            <span class="needs-label">per life saved (1-year estimate)</span>
          </div>
          <div class="needs-detail" id="needsCostPerCase">–</div>
        </div>
      </div>
    </section>
  </main>

  <!-- Compare countries view -->
  <section id="compare" style="display:none">
    <div class="trendCanvasWrap">
      <canvas id="bars"></canvas>
      <div id="barsTip" class="trendTooltip" style="display:none"></div>
    </div>
  </section>

  <script src="engine.js"></script>
  <script src="app.js" defer></script>
</body>
</html>
